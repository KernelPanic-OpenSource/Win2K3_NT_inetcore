//--------------------------------------------------------------------------------------------
//
//	Copyright (c) Microsoft Corporation, 1996-97
//
//	Description:
//
//		Microsoft Internet LDAP Client DLL.
//
//	Authors:
//
//		Umesh Madan 
//		RobertC	4/17/96	Modified for LDAPCLI
//
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
//
// INCLUDES
//
//--------------------------------------------------------------------------------------------
#include "ldappch.h"
#include "ldapsspi.h"

//--------------------------------------------------------------------------------------------
//
// GLOBALS
//
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
//
// PROTOTYPES
//
//--------------------------------------------------------------------------------------------

//--------------------------------------------------------------------------------------------
//
// FUNCTIONS
//
//--------------------------------------------------------------------------------------------

extern "C" BOOL WINAPI DllMain(HINSTANCE hInstDLL, DWORD dwReason, LPVOID lpReserved)
{
	switch (dwReason)
	{
		case DLL_PROCESS_ATTACH:
			{
			if (!FInitSocketDLL())
				{
				return FALSE;
				}
			g_hrInitSSPI = HrInitializeSSPI();
			} break;
			
		case DLL_PROCESS_DETACH:
			FreeSocketDLL();
			HrTerminateSSPI();
			break;
			
		default:
			break;	
	}
		
	return TRUE;
}

