#ifndef I_QI_IMPL_H_
#define I_QI_IMPL_H_
#pragma INCMSG("--- Beg 'qi_impl.h'")

#define Data1_IAdviseSink                  0x0000010f
#define Data1_IAdviseSink2                 0x00000125
#define Data1_IAdviseSinkEx                0x3af24290
#define Data1_IBindCtx                     0x0000000e
#define Data1_IBindHost                    0xfc4801a1
#define Data1_IBrowserService              0x02ba3b52
#define Data1_ICDataDoc                    0xF413E4C0
#define Data1_IClassFactory                0x00000001
#define Data1_IClassFactory2               0xb196b28f
#define Data1_IConnectionPoint             0xb196b286
#define Data1_IConnectionPointContainer    0xb196b284
#define Data1_ICreateErrorInfo             0x22f03340
#define Data1_ICreateTypeInfo              0x00020405
#define Data1_ICreateTypeLib               0x00020406
#define Data1_IDataAdviseHolder            0x00000110
#define Data1_IDataObject                  0x0000010e
#define Data1_DataSource                   0x7c0ffab3
#define Data1_DataSourceListener           0x7c0ffab2
#define Data1_IDATASRCListener             0x3050f380
#define Data1_IDispatch                    0x00020400
#define Data1_IDispObserver                0x3050f442
#define Data1_IDropSource                  0x00000121
#define Data1_IDropTarget                  0x00000122
#define Data1_IEnumCallback                0x00000108
#define Data1_IEnumConnectionPoints        0xb196b285
#define Data1_IEnumConnections             0xb196b287
#define Data1_IEnumFORMATETC               0x00000103
#define Data1_IEnumGeneric                 0x00000106
#define Data1_IEnumHolder                  0x00000107
#define Data1_IEnumMoniker                 0x00000102
#define Data1_IEnumOLEVERB                 0x00000104
#define Data1_IEnumSTATDATA                0x00000105
#define Data1_IEnumSTATSTG                 0x0000000d
#define Data1_IEnumString                  0x00000101
#define Data1_IEnumOleUndoUnits            0xb3e7c340
#define Data1_IEnumUnknown                 0x00000100
#define Data1_IEnumVARIANT                 0x00020404
#define Data1_IErrorInfo                   0x1cf2b120
#define Data1_IExternalConnection          0x00000019
#define Data1_IFont                        0xbef6e002
#define Data1_IFontDisp                    0xbef6e003
#define Data1_IForm                        0x04598fc8
#define Data1_IFormExpert                  0x04598fc5
#define Data1_IGangConnectWithDefault      0x6d5140c0
#define Data1_IHlinkTarget                 0x79eac9c4
#define Data1_IInternalMoniker             0x00000011
#define Data1_ILockBytes                   0x0000000a
#define Data1_IMalloc                      0x00000002
#define Data1_IMarshal                     0x00000003
#define Data1_IMessageFilter               0x00000016
#define Data1_IMoniker                     0x0000000f
#define Data1_IMonikerProp                 0xa5ca5f7f
#define Data1_IOleCommandTarget            0xb722bccb
#define Data1_IOleDocument                 0xb722bcc5
#define Data1_IOleDocumentView             0xb722bcc6
#define Data1_IOleAdviseHolder             0x00000111
#define Data1_IOleCache                    0x0000011e
#define Data1_IOleCache2                   0x00000128
#define Data1_IOleCacheControl             0x00000129
#define Data1_IOleClientSite               0x00000118
#define Data1_IOleParentUndoUnit           0xa1faf330
#define Data1_IOleContainer                0x0000011b
#define Data1_IOleControl                  0xb196b288
#define Data1_IOleControlSite              0xb196b289
#define Data1_IOleInPlaceActiveObject      0x00000117
#define Data1_IOleInPlaceFrame             0x00000116
#define Data1_IOleInPlaceObject            0x00000113
#define Data1_IOleInPlaceObjectWindowless  0x1c2056cc
#define Data1_IOleInPlaceSite              0x00000119
#define Data1_IOleInPlaceSiteEx            0x9c2cad80
#define Data1_IOleInPlaceSiteWindowless    0x922eada0
#define Data1_IOleInPlaceUIWindow          0x00000115
#define Data1_IOleItemContainer            0x0000011c
#define Data1_IOleLink                     0x0000011d
#define Data1_IOleManager                  0x0000011f
#define Data1_IOleObject                   0x00000112
#define Data1_IOlePresObj                  0x00000120
#define Data1_IOlePropertyFrame            0xb83bb801
#define Data1_IOleStandardTool             0xd97877c4
#define Data1_IOleUndoUnit                 0x894ad3b0
#define Data1_IOleUndoManager              0xd001f200
#define Data1_IOleWindow                   0x00000114
#define Data1_IPSFactory                   0x00000009
#define Data1_IPSFactoryBuffer             0xd5f569d0
#define Data1_IParseDisplayName            0x0000011a
#define Data1_IPerPropertyBrowsing         0x376bd3aa
#define Data1_IPersist                     0x0000010c
#define Data1_IPersistFile                 0x0000010b
#define Data1_IPersistHistory              0x91A565C1
#define Data1_IPersistMoniker              0x79eac9c9
#define Data1_IPersistStorage              0x0000010a
#define Data1_IPersistStream               0x00000109
#define Data1_IPersistStreamInit           0x7fd52380
#define Data1_IPersistPropertyBag          0x37D84F60
#define Data1_IPersistHTML                 0x049948d1
#define Data1_IPicture                     0x7bf80980
#define Data1_IPictureDisp                 0x7bf80981
#define Data1_IPointerInactive             0x55980ba0
#define Data1_IPropertyNotifySink          0x9bfbbc02
#define Data1_IPropertyPage                0xb196b28d
#define Data1_IPropertyPage2               0x01e44665
#define Data1_IPropertyPage3               0xb83bb803
#define Data1_IPropertyPageInPlace         0xb83bb802
#define Data1_IPropertyPageSite            0xb196b28c
#define Data1_IPropertyPageSite2           0xb83bb804
#define Data1_IProvideClassInfo            0xb196b283
#define Data1_IProvideClassInfo2           0xa6bc3ac0
#define Data1_IProvideDynamicClassInfo     0x6d5140d1
#define Data1_IProvideMultipleClassInfo    0xa7aba9c1
#define Data1_IQuickActivate               0xcf51ed10
#define Data1_IRequireClasses              0x6d5140d0
#define Data1_IRootStorage                 0x00000012
#define Data1_IRunnableObject              0x00000126
#define Data1_IRunningObjectTable          0x00000010
#define Data1_ISelectionContainer          0x6d5140c6
#define Data1_IServiceProvider             0x6d5140c1
#define Data1_ISimpleFrameSite             0x742b0e01
#define Data1_ISpecifyPropertyPages        0xb196b28b
#define Data1_IStdMarshalInfo              0x00000018
#define Data1_IStorage                     0x0000000b
#define Data1_IStream                      0x0000000c
#define Data1_ISupportErrorInfo            0xdf0b3d60
#define Data1_ITargetContainer             0x7847EC01
#define Data1_ITargetEmbedding             0x548793c0
#define Data1_ITargetFrame                 0xd5f78c80
#define Data1_ITargetFrame2                0x3abac181
#define Data1_ITargetNotify                0x863a99a0
#define Data1_ITargetNotify2               0x3050f6b1
#define Data1_ITypeComp                    0x00020403
#define Data1_ITypeInfo                    0x00020401
#define Data1_ITypeLib                     0x00020402
#define Data1_IUnknown                     0x00000000
#define Data1_IViewObject                  0x0000010d
#define Data1_IViewObject2                 0x00000127
#define Data1_IViewObjectEx                0x3af24292
#define Data1_IWeakRef                     0x0000001a
#define Data1_ICategorizeProperties        0x4d07fc10
#define Data1_IAccessible                  0x618736e0
#define Data1_IHTMLFrameBase               0x3050f311
#define Data1_IHTMLTextSite                0x1ff6aa71
#define Data1_IHTMLImageSite               0x49A4B4C0
#define Data1_IHTMLBodyElement             0x3050f1d8
#define Data1_IHTMLFontElement             0x3050f1d9
#define Data1_IHTMLAnchorElement           0x3050f1da
#define Data1_IHTMLAnchorElement2          0x3050f825
#define Data1_IHTMLUListElement            0x3050f1dd
#define Data1_IHTMLOListElement            0x3050f1de
#define Data1_IHTMLLIElement               0x3050f1e0
#define Data1_IHTMLBRElement               0x3050f1f0
#define Data1_IHTMLDListElement            0x3050f1f1
#define Data1_IHTMLDDElement               0x3050f1f2
#define Data1_IHTMLDTElement               0x3050f1f3
#define Data1_IHTMLHRElement               0x3050f1f4
#define Data1_IHTMLParaElement             0x3050f1f5
#define Data1_IHTMLHeaderElement           0x3050f1f6
#define Data1_IHTMLDivElement              0x3050f200
#define Data1_IHTMLBaseFontElement         0x3050f202
#define Data1_IGetUniqueID                 0xaf8665b0
#define Data1_CSubForm                     0x3050f1c7
#define Data1_IBoundObjectSite             0x9BFBBC01
#define Data1_IBitmapSurface               0x3050f2ef 
#define Data1_IGdiSurface                  0x3050f2f0 
#define Data1_IDDSurface                   0x3050f2f1 
#define Data1_IBitmapSurfaceFactory        0x3050f2f2 
#define Data1_IGdiSurfaceFactory           0x3050f2f3 
#define Data1_IDDSurfaceFactory            0x3050f2f4 
#define Data1_IRGBColorTable               0x3050f2f5 
#define Data1_IDispatchEx                  0xa6ef9860
#define Data1_IHTMLEventObj                0x3050f32d
#define Data1_IHTMLWindow2                 0x332c4427
#define Data1_IHTMLWindow3                 0x3050f4ae
#define Data1_IHTMLWindow4                 0x3050f6cf
#define Data1_IHTMLFramesCollection2       0x332c4426
#define Data1_IHTMLDocument                0x626FC520
#define Data1_IHTMLDocument2               0x332c4425
#define Data1_IHTMLDocument3               0x3050f485
#define Data1_IHTMLDocument4               0x3050f69a
#define Data1_IHTMLDocument5               0x3050f80c
#define Data1_IHTMLDataTransfer            0x3050f4b3
#define Data1_IMarqueeInfo                 0x0bdc6ae0
#define Data1_IObjectSafety                0xcb5bdc81
#define Data1_IShellPropSheetExt           0x000214E9
#define Data1_IHTMLScreen                  0x3050f35c
#define Data1_IHTMLScreen2                 0x3050f84a
#define Data1_IHTMLViewFilter              0x3050f2f1
#define Data1_IHTMLViewFilterSite          0x3050f2f4
#define Data1_ITimerService                0x3050f35f
#define Data1_ITimer                       0x3050f360
#define Data1_ITimerSink                   0x3050f361
#define Data1_IHTMLLocation                0x163BB1E0
#define Data1_IHTMLElement                 0x3050f1ff
#define Data1_IHTMLElement2                0x3050f434
#define Data1_IHTMLElement3                0x3050f673
#define Data1_IHTMLElement4                0x3050f80f
#define Data1_IInternetHostSecurityManager 0x3af280b6
#define Data1_IHTMLTxtRange                0x3050F220
#define Data1_IHTMLTxtRangeCollection      0x3050f7ed
#define Data1_IHTMLTextRangeMetrics        0x3050F40B
#define Data1_IHTMLTextRangeMetrics2       0x3050f4a6
#define Data1_ICustomDoc                   0x3050f3f0
#define Data1_ICSSFilterSite               0x3050f3ed
#define Data1_IHTMLDatabinding             0x3050f3f2
#define Data1_IObjectIdentity              0xCA04B7E6
#define Data1_IHTMLTableRow                0x3050f23c
#define Data1_IHTMLTableRowMetrics         0x3050f413
#define Data1_IBindStatusCallback          0x79eac9c1
#define Data1_IWindowForBindingUI          0x79EAC9D5
#define Data1_IDebugDocumentHost           0x51973C27
#define Data1_IHTMLEventObj2               0x3050f48B
#define Data1_IWebBridge                   0xAE24FDAD
#define Data1_IElementBehavior             0x3050f425
#define Data1_IElementBehaviorUI           0x3050f4bf
#define Data1_IElementBehaviorSite         0x3050f427
#define Data1_IElementBehaviorSiteOM       0x3050f489
#define Data1_IElementBehaviorSiteOM2      0x3050f659
#define Data1_IElementBehaviorSiteRender   0x3050f4a7
#define Data1_IElementBehaviorSiteCategory 0x3050f4ee
#define Data1_IElementBehaviorSiteLayout   0x3050f6b7
#define Data1_IElementBehaviorSiteLayout2  0x3050f847
#define Data1_IElementBehaviorFactory      0x3050f429
#define Data1_IElementNamespaceTable       0x3050f670
#define Data1_IElementNamespace            0x3050f671
#define Data1_IElementNamespaceFactory     0x3050f672
#define Data1_IHTCDefaultDispatch          0x3050f4fd
#define Data1_IHTCPropertyBehavior         0x3050f5df
#define Data1_IHTCEventBehavior            0x3050f4ff
#define Data1_IHTCAttachBehavior           0x3050f5f4
#define Data1_IProfferService              0xcb728b20
#define Data1_IPersistPropertyBag2         0x22F55881
#ifdef VSTUDIO7
#define Data1_IIdentityBehavior            0x3050f60c
#define Data1_IIdentityBehaviorFactory     0x3050f60d
#endif //VSTUDIO7
#define Data1_ICSSFilter                   0x3050f3ec
#define Data1_IHTMLRect                    0x3050f4a3
#define Data1_IHTMLRectCollection          0x3050f4a4
#define Data1_IHTMLTableRow2               0x3050f4a1
#define Data1_IHTMLTableRow3               0x3050f82c
#define Data1_IRecalcEngine                0x3050f496
#define Data1_IRecalcHost                  0x3050f497
#define Data1_IObjectWithSite              0xFC4801A3
#define Data1_IMarkupPointer               0x3050f49f
#define Data1_IMarkupPointer2              0x3050f675
#define Data1_IMarkupServices              0x3050f4a0
#define Data1_IMarkupServices2             0x3050f682
#define Data1_IMarkupContainer             0x3050f5f9
#define Data1_IMarkupContainer2            0x3050f648
#define Data1_IHTMLChangeLog               0x3050f649
#define Data1_IHTMLChangePlayback          0x3050f6e0
#define Data1_IHTMLViewServices            0x3050f603
#define Data1_IHTMLPopup                   0x3050f666
#if DBG==1
#define Data1_IHTMLChangeSink              0x3050f64a
#endif // DBG==1
#define Data1_IHTMLEventObj2               0x3050f48B
#define Data1_IHTMLPersistDataOLD          0x3050f48e
#define Data1_IHTMLPersistDataOM           0x3050f4c0
#define Data1_IHTMLPersistData             0x3050f4c5
#define Data1_IActiveScriptSite            0xdb01a1e3
#define Data1_IScriptletHandler            0xa001a870
#define Data1_IScriptletHandlerConstructor 0xa3d52a50
#define Data1_IClassFactoryEx              0x342d1ea0
#define Data1_IHTMLDOMNode                 0x3050f5da
#define Data1_IHTMLDOMNode2                0x3050f80b
#define Data1_IHTMLDOMTextNode             0x3050f4b1
#define Data1_IHTMLDOMTextNode2            0x3050f809
#define Data1_IHTMLDOMAttribute            0x3050f4b0
#define Data1_IHTMLDOMAttribute2           0x3050f810
#define Data1_IHTMLDOMCollectionator       0x3050f4af
#define Data1_IHTMLAttributeCollection     0x3050f4c3
#define Data1_IHTMLAttributeCollection2    0x3050f80a
#define Data1_IHTMLUniqueName              0x3050f4d0
#define Data1_IHTMLObjectElement           0x3050f24f
#define Data1_IHTMLObjectElement2          0x3050f4cd
#define Data1_IHTMLObjectElement3          0x3050f827
#define Data1_IHTMLTable                   0x3050f21e
#define Data1_IHTMLTable2                  0x3050f4ad
#define Data1_IHTMLTable3                  0x3050f829
#define Data1_IScriptletSite               0xc5f21c30
#define Data1_IHTMLIFrameElement2          0x3050f4e6
#define Data1_IHTMLLinkElement2            0x3050f4e5
#define Data1_IHTMLLinkElement3            0x3050f81e
#define Data1_IHTMLIFrameElement           0x3050f315
#define Data1_IHTMLLinkElement             0x3050f205
#define Data1_ISegmentList                 0x3050f605
#define Data1_ISegment                     0x3050f683
#define Data1_IHighlightRenderingServices  0x3050f606
#define Data1_IHTMLFormElement2            0x3050f4f6
#define Data1_IHTMLFormElement3            0x3050f836
#define Data1_IHTMLCaret                   0x3050f604
#define Data1_IDispClient                  0x3050f437
#define Data1_IElementAdorner              0x3050f607
#define Data1_IHTMLAppBehavior             0x3050f5ca
#define Data1_IHTMLAppBehavior2            0x3050f5c9
#define Data1_IHTMLAppBehavior3            0x3050f5cd
#define Data1_IHTMLInputElement            0x3050f5d2
#define Data1_IHTMLInputElement2           0x3050f821
#define Data1_IHTMLInputTextElement        0x3050f2a6
#define Data1_IHTMLInputHiddenElement      0x3050f2a4
#define Data1_IHTMLInputImage              0x3050f2c2
#define Data1_IHTMLInputButtonElement      0x3050f2b2
#define Data1_IHTMLDialog2                 0x3050f5e0
#define Data1_IHTMLInputFileElement        0x3050f2ad
#define Data1_IHTMLOptionButtonElement     0x3050f2bc
#define Data1_IRecalcProperty              0x3050f5d6
#define Data1_IHTMLDocumentFragment        0x3050f5e5
#define Data1_IHTMLElementCollection2      0x3050f5ee
#define Data1_IHTMLElementCollection3      0x3050f835
#define Data1_IHTMLAreasCollection2        0x3050f5ec
#define Data1_IHTMLAreasCollection3        0x3050f837
#define Data1_IHTMLSelectElement2          0x3050f5ed
#define Data1_IHTMLSelectElement4          0x3050f838
#define Data1_IHTMLControlRange            0x3050f29c
#define Data1_IHTMLControlRange2           0x3050f65e
#define Data1_IEditDebugServices           0x3050f60b
#define Data1_IRecalcHostDebug             0x3050f5f7
#define Data1_IMarkupTextFrags             0x3050f5fa
#define Data1_ISecureUrlHost               0xc81984c4
#define Data1_IHTMLElementLayout           0x3050f637
#define Data1_IHTMLLayoutFactory           0x3050f638
#define Data1_IHTMLLayout                  0x3050f639
#define Data1_IHTMLLayoutContext           0x3050f63a
#define Data1_IHTMLBreakTable              0x3050f63b
#define Data1_IXMLGenericParse             0xe4e23071
#define Data1_IHTMLStyle                   0x3050f25e
#define Data1_IHTMLStyle2                  0x3050f4a2
#define Data1_IHTMLStyle3                  0x3050f656
#define Data1_IHTMLStyle4                  0x3050f816
#define Data1_IHTMLRuleStyle               0x3050f3cf
#define Data1_IHTMLRuleStyle2              0x3050f4ac
#define Data1_IHTMLRuleStyle3              0x3050f657
#define Data1_IHTMLRuleStyle4              0x3050f817
#define Data1_IHTMLCurrentStyle            0x3050f3db
#define Data1_IHTMLCurrentStyle2           0x3050f658
#define Data1_IHTMLCurrentStyle3           0x3050f818
#define Data1_IHTMLRenderStyle             0x3050f6ae
#define Data1_IHTMLSubmitData              0x3050f645
#define Data1_IElementBehaviorSubmit       0x3050f646
#define Data1_IHTMLProtectedElement        0x3050f65a
#define Data1_IHTMLElementDefaults         0x3050f6c9
#define Data1_IHTMLElementRender           0x3050f669
#define Data1_ITravelLogClient             0x3050f67a
#define Data1_IWebBrowser                  0xeab22ac1
#define Data1_IWebBrowserApp               0x0002df05
#define Data1_IWebBrowser2                 0xd30c1661
#define Data1_IHTMLPrivateWindow           0x3050f6dc
#define Data1_IHTMLPrivateWindow2          0x3050f7e5
#define Data1_IHTMLPrivateWindow3          0x3050f840
#define Data1_IHTMLEventObj3               0x3050f680
#define Data1_IHTMLEventObj4               0x3050f814
#define Data1_IHTMLPaintSite               0x3050f6a7
#define Data1_IHTMLFilterPaintSite         0x3050f6d3
#define Data1_IHlinkFrame                  0x79eac9c5 
#define Data1_IHTMLPainter                 0x3050f6a6
#define Data1_IHTMLPainterEventInfo        0x3050f6df
#define Data1_IDisplayServices             0x3050f69d
#define Data1_IIMEServices                 0x3050f6ca
#define Data1_IPrivacyServices             0x3050f84b
#define Data1_IHTCAttachBehavior2          0x3050f7eb
#define Data1_IHTMLStyleSheet              0x3050f2e3
#define Data1_IHTMLStyleSheet2             0x3050f3d1
#define Data1_IHTMLFrameElement            0x3050f313
#define Data1_IHTMLFrameElement2           0x3050f7f5
#define Data1_IElementNamespacePrivate     0x3050f7ff
#define Data1_IInternetSecurityMgrSite     0x79eac9ed
#define Data1_IInternetSecurityManager     0x79eac9ee
#define Data1_ITargetFramePriv             0x9216E421
#define Data1_IUrlHistoryNotify            0xbc40bec1 
#define Data1_IElementNamespaceFactory2    0x3050f805
#define Data1_IHTMLCommentElement          0x3050f20c
#define Data1_IHTMLCommentElement2         0x3050f813
#define Data1_IHTMLDOMImplementation       0x3050f80d
#define Data1_IHTMLHtmlElement             0x3050f81c
#define Data1_IHTMLHeadElement             0x3050f81d
#define Data1_IHTMLMetaElement             0x3050f203
#define Data1_IHTMLMetaElement2            0x3050f81f
#define Data1_IHTMLTableSection            0x3050f23b
#define Data1_IHTMLTableSection2           0x3050f5c7
#define Data1_IHTMLTableSection3           0x3050f82b
#define Data1_IHTMLOptionElement           0x3050f211
#define Data1_IHTMLOptionElement3          0x3050f820
#define Data1_IHTMLTableCell               0x3050f23d
#define Data1_IHTMLTableCell2              0x3050f82d
#define Data1_IHTMLListElement             0x3050f20e
#define Data1_IHTMLListElement2            0x3050f822
#define Data1_IHTMLBlockElement            0x3050f208
#define Data1_IHTMLBlockElement2           0x3050f823
#define Data1_IHTMLPhraseElement           0x3050f20a
#define Data1_IHTMLPhraseElement2          0x3050f824
#define Data1_IHTMLImgElement2             0x3050f826
#define Data1_IHTMLScriptElement2          0x3050f828
#define Data1_IHTMLTableCol                0x3050f23a
#define Data1_IHTMLTableCol2               0x3050f82a
#define Data1_IHTMLIsIndexElement          0x3050f206
#define Data1_IHTMLIsIndexElement2         0x3050f82f
#define Data1_IHTMLLabelElement            0x3050f32a
#define Data1_IHTMLLabelElement2           0x3050f832
#define Data1_IHTMLLegendElement           0x3050f3ea
#define Data1_IHTMLLegendElement2          0x3050f834
#define Data1_IHTMLFieldSetElement         0x3050f3e7
#define Data1_IHTMLFieldSetElement2        0x3050f833
#define Data1_IHTMLTextContainer           0x3050f230
#define Data1_IEnumPrivacyRecords          0x3050f844

#if DBG==1
#define Data1_IDebugWindowProxy            0x3050f592
#define Data1_IDebugWindow                 0x3050f593
#endif


#define QI_INHERITS(pObj, itf)              \
    case Data1_##itf:                       \
        if (iid == IID_##itf)               \
        {                                   \
        *ppv = (itf *)pObj;                 \
        }                                   \
        break;                              \

#define QI_INHERITS2(pObj, itf, itfDerived) \
    case Data1_##itf:                       \
        if (iid == IID_##itf)               \
        {                                   \
        *ppv = (itfDerived *)pObj;          \
        }                                   \
        break;                              \

#define QI_TEAROFF(pObj, itf, pUnkOuter)    \
    case Data1_##itf:                       \
        if (iid == IID_##itf)               \
        {                                   \
        HRESULT hr = CreateTearOffThunk(    \
            pObj,                           \
            (void *)pObj->s_apfn##itf,      \
            pUnkOuter,                      \
            ppv);                           \
        if (hr)                             \
            RRETURN(hr);                    \
        }                                   \
        break;                              \

#define QI_TEAROFF2(pObj, itf, itfDerived, pUnkOuter) \
    case Data1_##itf:                                 \
        if (iid == IID_##itf)                         \
        {                                             \
        HRESULT hr = CreateTearOffThunk(              \
            pObj,                                     \
            (void *)pObj->s_apfn##itfDerived,         \
            pUnkOuter,                                \
            ppv);                                     \
        if (hr)                                       \
            RRETURN(hr);                              \
        }                                             \
        break;                                        \

#define QI_HTML_TEAROFF(pObj, itf, pUnkOuter)    \
    case Data1_##itf:                       \
        if (iid == IID_##itf)               \
        {                                   \
        HRESULT hr = CreateTearOffThunk(    \
            pObj,                           \
            (void *)pObj->s_apfnpd##itf,    \
            pUnkOuter,                      \
            ppv,                            \
            (void *)s_ppropdescsInVtblOrder##itf);                 \
        if (hr)                             \
            RRETURN(hr);                    \
        }                                   \
        break;                              \


extern const IID * const g_apIID_IDispatchEx[];

#define QI_TEAROFF_DISPEX(pObj, pUnkOuter) \
    case Data1_IDispatch:                             \
    case Data1_IDispatchEx:                           \
        if (iid == IID_IDispatch || iid == IID_IDispatchEx)\
        {                                             \
        HRESULT hr = CreateTearOffThunk(              \
            pObj,                                     \
            pObj->s_apfnIDispatchEx,                 \
            pUnkOuter,                                \
            ppv,                                      \
            NULL,                                     \
            NULL,                                     \
            0,                                        \
            g_apIID_IDispatchEx);                     \
        if (hr)                                       \
            RRETURN(hr);                              \
        }                                             \
        break;                                        \

#define QI_FALLTHRU(itfName1__, itfName2__) case Data1_##itfName1__: if (iid == IID_##itfName1__) goto handle_##itfName2__; else break; 
#define QI_CASE(itfName__) case Data1_##itfName__: if (iid == IID_##itfName__) goto handle_##itfName__; else break; handle_##itfName__: ;

#pragma INCMSG("--- End 'qi_impl.h'")
#else
#pragma INCMSG("*** Dup 'qi_impl.h'")
#endif
